What Is On-Balance Volume (OBV)?
On-balance volume (OBV), developed by Joseph Granville in 1963, is a pivotal technical trading indicator that leverages volume flow to anticipate stock price movements. Granville proposed that market volume is the driving force behind significant price shifts. His OBV metric aims to forecast when major market moves will occur based on changes in volume. According to Granville, when volume rises sharply without a corresponding price change, an eventual significant price movement is likely—either upward or downward—due to this 'spring being wound tightly' effect.
1

Key Takeaways
Volume Drives Price Action: On-Balance Volume (OBV) is a momentum indicator that uses trading volume to anticipate changes in stock prices. It signals potential price movements based on volume shifts, as volume typically precedes price action.
Smart Money vs. Retail Investors: OBV helps distinguish between institutional investors—often referred to as "smart money"—and retail investors. When large institutions begin buying, OBV rises even if prices are flat; eventually, prices tend to follow the volume.
Cumulative Volume Calculation: The OBV is calculated by adding the volume to the previous OBV if a stock's closing price is higher than the previous day, subtracting the volume if it's lower, and keeping it unchanged if the price is identical.
Limitations and Considerations: As a leading indicator, OBV can produce false signals and may require confirmation from lagging indicators. Sudden volume spikes, due to events like earnings reports, can distort OBV readings.
OBV vs. Other Indicators: While OBV focuses on volume relative to the direction of price changes, other indicators like Volume-Price Trend (VPT) factor in the magnitude of price changes, offering different insights into market dynamics. 
Image
Image by Sabrina Jiang © Investopedia 2021
Understanding the On-Balance Volume (OBV) Formula


OBV
=
OBV
p
r
e
v
+
{
volume,
if close
>
close
p
r
e
v
0,
if close
=
close
p
r
e
v
−
volume,
if close
<
close
p
r
e
v
where:
OBV
=
Current on-balance volume level
OBV
p
r
e
v
=
Previous on-balance volume level
volume
=
Latest trading volume amount
​
  
OBV=OBV 
prev
​
 + 
⎩
⎪
⎨
⎪
⎧
​
  
volume,
0,
−volume,
​
  
if close>close 
prev
​
 
if close=close 
prev
​
 
if close<close 
prev
​
 
​
 
where:
OBV=Current on-balance volume level
OBV 
prev
​
 =Previous on-balance volume level
volume=Latest trading volume amount
​
 

How to Calculate On-Balance Volume Effectively
On-balance volume provides a running total of an asset's trading volume and indicates whether this volume is flowing in or out of a given security or currency pair. The OBV is a cumulative total of volume (positive and negative). There are three rules implemented when calculating the OBV. They are:

1. If today's closing price is higher than yesterday's closing price, then: Current OBV = Previous OBV + today's volume

2. If today's closing price is lower than yesterday's closing price, then: Current OBV = Previous OBV - today's volume

3. If today's closing price equals yesterday's closing price, then: Current OBV = Previous OBV

Insights Provided by On-Balance Volume (OBV)
The theory behind OBV is based on the distinction between smart money—namely, institutional investors—and less sophisticated retail investors. As mutual funds and pension funds begin to buy into an issue that retail investors are selling, volume may increase even as the price remains relatively level. Eventually, volume drives the price upward. At that point, larger investors begin to sell, and smaller investors begin buying.

Although plotted on a price chart, the specific numerical value of OBV isn't important. The indicator itself is cumulative, while the time interval remains fixed by a dedicated starting point, meaning the real number value of OBV arbitrarily depends on the start date. Instead, traders focus on OBV movements over time; the slope of the OBV line is crucial for analysis.

 Analysts use OBV volumes to track large, institutional investors. They view divergences between volume and price as a sign of how "smart money" interacts with regular investors, hoping to spot opportunities against prevailing trends. For example, institutional money may drive up the price of an asset, then sell after other investors jump on the bandwagon.

Practical Application: Using OBV in Trading
Below is a list of 10 days' worth of a hypothetical stock's closing price and volume:

Day one: closing price equals $10, volume equals 25,200 shares
Day two: closing price equals $10.15, volume equals 30,000 shares
Day three: closing price equals $10.17, volume equals 25,600 shares
Day four: closing price equals $10.13, volume equals 32,000 shares
Day five: closing price equals $10.11, volume equals 23,000 shares
Day six: closing price equals $10.15, volume equals 40,000 shares
Day seven: closing price equals $10.20, volume equals 36,000 shares
Day eight: closing price equals $10.20, volume equals 20,500 shares
Day nine: closing price equals $10.22, volume equals 23,000 shares
Day 10: closing price equals $10.21, volume equals 27,500 shares
As can be seen, days two, three, six, seven and nine are up days, so these trading volumes are added to the OBV. Days four, five and 10 are down days, so these trading volumes are subtracted from the OBV. On day eight, no changes are made to the OBV since the closing price did not change. Given the days, the OBV for each of the 10 days is:

Day one OBV = 0
Day two OBV = 0 + 30,000 = 30,000
Day three OBV = 30,000 + 25,600 = 55,600
Day four OBV = 55,600 - 32,000 = 23,600
Day five OBV = 23,600 - 23,000 = 600
Day six OBV = 600 + 40,000 = 40,600
Day seven OBV = 40,600 + 36,000 = 76,600
Day eight OBV = 76,600
Day nine OBV = 76,600 + 23,000 = 99,600
Day 10 OBV = 99,600 - 27,500 = 72,100
Comparing OBV and Accumulation/Distribution Indicators
On-balance volume and the accumulation/distribution line are similar in that they are both momentum indicators that use volume to predict the movement of “smart money”. However, this is their only similarity. In the case of on-balance volume, it is calculated by summing the volume on an up-day and subtracting the volume on a down-day.

The formula used to create the accumulation/distribution (Acc/Dist) line is quite different than the OBV shown above. The formula for the Acc/Dist, without getting too complicated, is that it uses the position of the current price relative to its recent trading range and multiplies it by that period's volume.

Challenges and Limitations of Using On-Balance Volume
One limitation of OBV is that it is a leading indicator, meaning that it may produce predictions, but there is little it can say about what has actually happened in terms of the signals it produces. Because of this, it is prone to produce false signals. It can therefore be balanced by lagging indicators. Add a moving average line to the OBV to look for OBV line breakouts; you can confirm a breakout in the price if the OBV indicator makes a concurrent breakout.

Another note of caution in using the OBV is that a large spike in volume on a single day can throw off the indicator for quite a while. For instance, a surprise earnings announcement, being added or removed from an index, or massive institutional block trades can cause the indicator to spike or plummet, but the spike in volume may not be indicative of a trend.

What Is Average Daily Trading Volume?
Average daily trading volume (ADTV) is the average amount of shares traded each day for a given stock. It can be a useful metric because high or low trading volume attracts different types of traders. Traders and investors can use ADTV to assess liquidity, analyze volatility, optimize trade execution, and manage risk. ADTV can be used alongside OBV and other indicators to evaluate the market's activity.

What's the Difference Between On-Balance Volume and Volume-Price Trend?
Volume-Price Trend (VPT) is similar to on-balance volume in that it measures the cumulative volume and provides traders with information about a security’s money flow. But whereas OBV looks at volume just according to whether the close was higher or lower, VPT looks at how much higher or lower it was. This helps determine a security’s price direction and strength of price change.

Is On-Balance Volume Leading or Lagging?
On-Balance Volume is a leading indicator: it produces predictions, but it doesn't provide specific information on exactly what happened or why. This can lead to wrong interpretations. OBV should be used alongside lagging indicators for better effectiveness.



The Bottom Line
On-balance volume (OBV) is a technical indicator that measures positive and negative volume flow and analyzes the trading direction. It appears as a single line that helps investors make trading decisions and identify buy or sell points. However, OBV doesn't provide specific information about the financial asset, which can lead to misinterpretations. Therefore, traders should balance OBV by using lagging indicators.


<!DOCTYPE html>
<html lang="en">
<head> <!-- Styles as detailed --> </head>
<body>
  <!-- Panels: symbols, analysis, trading -->
  <div id="order-book-section"> <!-- DOM table + OBV container --> </div>
  <script>
    const ws = new WebSocket(`ws://localhost:${CONFIG.PORT}`);
    ws.onmessage = (event) => { /* Handle market_update, update DOM/OBV */ };
    function updateOrderBook(data) { /* Table render */ }
    function updateOBVScale(scale) { /* Visual tilt + bar */ }
    // Other dashboard logic
  </script>
</body>
</html>







require('dotenv').config();
const express = require('express');
const http = require('http');
const path = require('path');
const WebSocket = require('ws');
const crypto = require('crypto');
const axios = require('axios');
const fs = require('fs');
const { EventEmitter } = require('events');

const CONFIG = {
  PORT: process.env.PORT || 3001,
  KUCOIN_FUTURES_API: 'https://api-futures.kucoin.com',
  TRADING: { /* full config as above */ },
  OBV: { PERIODS: 15, TIMEFRAME: '1h' }
};

const kucoinAPI = {
  getOrderBook: async (symbol) => {
    // Add HMAC signing here for auth
    const res = await axios.get(`${CONFIG.KUCOIN_FUTURES_API}/api/v1/level2/depth100?symbol=${symbol}`);
    return res.data;
  },
  getKline: async (symbol, timeframe, limit) => {
    const res = await axios.get(`${CONFIG.KUCOIN_FUTURES_API}/api/v1/kline/query?symbol=${symbol}&granularity=${timeframe === '1h' ? 60 : timeframe}&limit=${limit}`);
    return res.data;
  }
  // Other methods: getServerTime, placeOrder, etc.
};

async function calculateOBVBalanceScale(symbol) {
  // Full logic as previously detailed
  // ...
}

async function updateMarketData(symbol) {
  // Fetch + broadcast DOM/OBV
  // ...
}

// Full server setup: app = express(), server = http.createServer(app), wss = new WebSocket.Server({ server })
// Event handlers, startup(), shutdown, etc.






Key Features of v3.5.1
Core Enhancements: Integrates Depth of Market (DOM) with real-time bid/ask levels (top 10 displayed) and a 15-period On-Balance Volume (OBV) balance scale normalized to -100/+100 for visualizing volume imbalances.
Signal System: Maintains 8-indicator scoring (-100 to +100) with configurable profiles, now complemented by OBV for volume confirmation.
Risk Management: USDT-based sizing (0.5% default), leverage-adjusted SL/TP (0.5%/2.0%), break-even at >0 profit, and trailing stops (staircase mode default).
UI Design: Dark-themed dashboard with responsive panels; DOM table uses color-coded bids (green)/asks (red); OBV scale visualized as a tilted gradient bar.
Backend Logic: Node.js with Express/WebSocket; fetches KuCoin Level 2 order book and klines for OBV; broadcasts updates every 5-10 seconds.
Logic Overview
The backend handles API authentication via HMAC-SHA256 (using crypto module), fetches order book data via /api/v1/level2/depth100, and computes OBV from kline candles. Entry logic places limits at the 9th DOM level, with automated exits triggering on price updates. Risk calculations incorporate fees (0.02% maker) and slippage (0.02% buffer). Signal generation aggregates indicator points, now optionally filtered by OBV scale (>50 suggests bullish pressure).

Design Build
Frontend uses vanilla JS with inline CSS for a lightweight, dark-mode UI (primary bg: #0a0e17). Layout: Left panel (symbols), center (analysis + DOM table), right (trading controls). OBV scale rotates via CSS transforms (e.g., rotate(${scale / 20}deg)), with red-green gradients for bearish/bullish tilts. Ensure responsive breakpoints at 1920px (desktop) and 768px (mobile).

Implementation Steps
Start with Node.js setup: npm install express ws axios dotenv crypto fs events. Configure .env with KuCoin keys. Run via node server.js or PM2 for production. Test DOM/OBV with XBTUSDTM – expect scale updates on kline fetches.

In-Depth Logic and Design for v3.5.1: KuCoin Perpetual Futures Dashboard
This detailed survey compiles the full build for v3.5.1, drawing from the project's monolithic Node.js architecture. It includes every aspect of logic (signal calc, entry/exit, DOM/OBV integration), design specifications (UI components, styles), configurations, and enhancements. The system is semi-automated for KuCoin USDT-M perps, emphasizing risk-managed trading with real-time analysis.

Core Configurations and Settings
Environment Variables (.env file):
KUCOIN_API_KEY: Your API key
KUCOIN_API_SECRET: API secret
KUCOIN_API_PASSPHRASE: API passphrase
PORT: 3001 (default)
NODE_ENV: development (or production)
ENABLE_TRADING: false (for testing)
Trading Parameters (CONFIG.TRADING object in server.js):
INITIAL_SL_ROI: 0.5 (0.5% ROI loss)
INITIAL_TP_ROI: 2.0 (2.0% ROI gain)
BREAK_EVEN_BUFFER: 0.1 (0.1% above fee-adjusted break-even)
TRAILING_STEP_PERCENT: 0.15 (trail every 0.15% ROI)
TRAILING_MOVE_PERCENT: 0.05 (move SL by 0.05% per step)
TRAILING_MODE: 'staircase' (options: 'staircase', 'atr', 'dynamic')
ATR_TRAILING_MULTIPLIER: 1.5
POSITION_SIZE_PERCENT: 0.5 (0.5% of balance)
DEFAULT_LEVERAGE: 10
MAX_POSITIONS: 5
SLIPPAGE_BUFFER_PERCENT: 0.02
MAKER_FEE: 0.0002
TAKER_FEE: 0.0006
MAINTENANCE_MARGIN_PERCENT: 0.5
ENABLE_PARTIAL_TP: false
PARTIAL_TP_PERCENT: 50
TP1_ROI: 1.0
TP2_ROI: 2.0
AUTO_LEVERAGE_TIERS: [{ maxVolatility: 0.5, leverage: 50 }, { maxVolatility: 1.0, leverage: 25 }, { maxVolatility: 2.0, leverage: 15 }, { maxVolatility: 3.0, leverage: 10 }, { maxVolatility: 5.0, leverage: 5 }]
OBV-Specific Settings (CONFIG.OBV):
PERIODS: 15
TIMEFRAME: '1h' (adjustable: '1min', '5min', etc.)
Signal Weights (signal-weights.js, default profile):
rsi: { max: 25, oversold: 30, oversoldMild: 40, overbought: 70, overboughtMild: 60 }
williamsR: { max: 20, oversold: -80, overbought: -20 }
macd: { max: 20 }
ao: { max: 15 }
emaTrend: { max: 20 }
stochastic: { max: 10, oversold: 20, overbought: 80 }
bollinger: { max: 10 }
activeProfile: 'default' (options: conservative, aggressive, balanced, scalping, swingTrading)
thresholds: { strongBuy: 70, buy: 50, buyWeak: 30, strongSell: -70, sell: -50, sellWeak: -30 }
Signal Generation Logic
The system computes a composite score from 8 indicators, normalized to -100/+100, with binary/threshold-based contributions. Logic is executed in backend loops (e.g., every 5s via WebSocket broadcasts).

RSI (14-period): +25 if <30, -25 if >70; proportional optimization suggested: 25 * (30 - rsi)/30 if <30.
Williams %R (14-period): +20 if <-80, -20 if >-20.
MACD (12/26/9): +20 if histogram >0, -20 if <0.
AO (5/34): +15 if >0, -15 if <0.
EMA Trend (50/200): +20 if EMA50 > EMA200, -20 if <.
Stochastic (14/3/3): +10 on bullish crossover (%K > %D after <), -10 on bearish.
Bollinger Bands (20, 2 std): +10 if price < lower band, -10 if > upper.
ATR (14): Volatility for trailing (no score); correlation with BB width ~0.5561.
Aggregation: Sum contributions; filter with regime detection (e.g., ADX >25 for trends).
Correlations (from audit): RSI-Williams ~0.7931 (raw), MACD-AO ~0.6592 (signals) – reduce redundancies.
Alerts: Sound/visual on thresholds crossed.
Entry and Exit Logic
Entry:
User selects symbol/timeframe, clicks LONG/SHORT.
System fetches DOM, places limit order at 9th bid (long) or ask (short).
On fill: Places stop-market SL (0.5% below) + limit TP (2% above) on KuCoin.
Exit & Automation:
Break-even: If profit >0 (after fees), SL → entry + buffer (0.1%).
Trailing: On +0.15% profit, SL trails 0.05%; ATR mode: stop = entry ± (ATR * 1.5).
Partial TP: If enabled, close 50% at 1% ROI, rest at 2%.
Manual: Close buttons; auto-close on SL/TP hit.
Position Sizing: (risk_amount / (entry - SL)) * leverage; deduct fees.
DOM + OBV Balance Scale Logic
DOM Fetch: /api/v1/level2/depth100 endpoint; display top 10 bids/asks.
OBV Calculation:
Fetch 30 klines (extra for safety); reverse to oldest first.
obv = 0; for each candle: if close > prev, obv += volume; if <, obv -= volume.
Recent 15 values: normalize scale = ((current - min) / (max - min || 1)) * 200 - 100.
Integration: Broadcast with market data; positive scale (>50) highlights bids (bullish pressure).
Correlations: OBV-RSI ~0.45, OBV-MACD ~0.60 – adds leading volume insight.
UI Design Specifications
Color Palette: bg-primary #0a0e17, accent-green #00ff88, accent-red #ff4757; gradients for signals.
Typography: JetBrains Mono (monospace) + Space Grotesk (display); sizes: 1.5rem headers, 0.8rem labels.
Layout: Flexbox/grid; left (symbols), center (analysis/DOM table), right (trading).
DOM Table: Border-collapse; bid rows green bg, ask red; columns: Price, Size (Bids), Size (Asks), Price.
OBV Scale: 300x40px bar; rotate via CSS; bar width = (abs(scale)/100)*50%; float left/right based on sign.
Responsive: Breakpoints at 1920px (desktop), 768px (mobile); dark theme only.
